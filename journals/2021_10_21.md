---
title: October 21st, 2021
---

- [John Papa on Twitter](https://twitter.com/John_Papa/status/1450878237572313088?t=krqtLEEZm2AK4yUYkkqiLg&s=09) #Inbox

- TODO akkoord op datadog pricing in email box 

- TODO mail Marieke sturen 

- TODO Oleg bellen over Adrian

- TODO Utrechtseweg 15, Utrecht Amoer dochter Fatiha cadeau sturen 

- TODO Tuindeco logfiles laten aggregeren 

- [[Tuindeco]] 
	 - 40.2017L

	 - 32.9904

- [[Medipreventie ShopWare 6]] Import airtable with n8n
	 - Spatie uit titel halen

	 - Category leeg maken bij varianten, overreven parent

	 - 

- [[Medipreventie ShopWare 6]] Reset images after import gone wrong
	 - Reset database:
		 - zcat dbmedi.prod.20211021-1440.sql.gz | mysql -u medipreventie -p medipreventieprod

	 - 

	 - Stap 1 remove images
		 - ```sql
SET FOREIGN_KEY_CHECKS=0;
DELETE FROM media;
DELETE FROM media_thumbnail;
DELETE FROM product_media;
SET FOREIGN_KEY_CHECKS=1;
```

	 - Stap 2: 
		 - Clear swag migration folders.

		 - ```sql
DELETE FROM swag_migration_data;
DELETE FROM swag_migration_logging;
DELETE FROM swag_migration_media_file;
DELETE FROM swag_migration_mapping;
```

	 - Properties:
		 - ```sql
select pgt.*, pgot.*, pgo.*, pg.* from property_group pg 
join property_group_option pgo on pg.id = pgo.property_group_id 
join property_group_option_translation pgot on pgo.id = pgot.property_group_option_id 
join property_group_translation pgt on pg.id = pgt.property_group_id WHERE pg.filterable = 0
```

	 - IMages:
		 - ```sql
SELECT p.id, pm.product_id, m.file_name, SUBSTR(m.file_name, 1, LENGTH(m.file_name) - 5) FROM product_media pm 
left join media m on pm.media_id = m.id
INNER JOIN product p ON p.id != pm.product_id
order BY m.file_name

DELETE FROM media WHERE  id IN (SELECT k.id FROM product_media pm LEFT join media k on pm.media_id = k.id INNER JOIN product p ON p.id != pm.product_id	GROUP BY k.id);


UPDATE media AS m SET m.file_name = '' WHERE m.id IN (SELECT pm.media_id FROM product_media pm)

```

	 - Update images:
		 - ```javascript

UPDATE media SET file_name = SUBSTR(file_name, 1, LENGTH(file_name) - 5)

SELECT DISTINCT pm.media_id 
                FROM product_media pm  
            WHERE pm.product_id NOT IN (SELECT p.id FROM product as p)
```

	 - ```javascript

SELECT SUBSTR(file_name, -5, LENGTH(file_name) - 0) FROM media WHERE SUBSTR(file_name, -5, LENGTH(file_name) - 0) REGEXP '[[:digit:]]{1}';

SELECT SUBSTR(file_name, -5, LENGTH(file_name) - 0) FROM media WHERE SUBSTR(file_name, -5, LENGTH(file_name) - 0) REGEXP '[[:digit:]]{2}'
```

	 - 

	 - Stap 3: 
		 - Backup media folder

		 - Clear media folder

		 - es:index:cleanup

		 - media:delete-unused

- 

- Import
	 - Universal Quick Capture for Roam Research
		 - From: Universal Quick Capture for Roam Research.json
